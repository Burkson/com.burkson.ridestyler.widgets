var __extends=(this&&this.__extends)||(function(){var extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();var TireConnectPlugin;(function(TireConnectPlugin){TireConnectPlugin.BaseURL=undefined;TireConnectPlugin.OpenInNewTab=!1;var HTMLHelper=RideStylerShowcase.HTMLHelper;var StringHelper=RideStylerShowcase.StringHelper;var VisibilityHelper=RideStylerShowcase.VisibilityHelper;var strings=RideStylerShowcase.strings;var RideStylerShowcaseTable=RideStylerShowcase.RideStylerShowcaseTable;var CustomWheelDetails=(function(_super){__extends(CustomWheelDetails,_super);function CustomWheelDetails(showcase){var _this=_super.call(this,showcase)||this;if(!TireConnectPlugin.BaseURL)
console.warn("Please set TireConnectPlugin.BaseURL to the URL of the TireConnect widget");return _this}
CustomWheelDetails.prototype.initializeComponent=function(){var _this=this;_super.prototype.initializeComponent.call(this);this.createTirePackageButton=HTMLHelper.createButton({className:'ridestyler-showcase-wheel-details-create-tire-package tire-connect-plugin-wheel-details-create-tire-package',appendTo:this.component,text:"Build Wheel and Tire Package",link:!0});this.setTirePackageButtonVisibility(!1);this.createTirePackageButton.addEventListener('click',function(){var _a=_this.state.getData(),currentWheel=_a.currentWheel,currentTireOption=_a.currentTireOption;var modal;var wheelFitments=currentWheel.WheelFitments;var recommendations=null;var batch=ridestyler.ajax.batch();for(var i=0;i<wheelFitments.length;i++){var wf=wheelFitments[i];batch.send(wf.PartNumber,{action:'tire/recommendsize',data:{BaseTireSizeDesc:currentTireOption.Front.Description,NewWheelDiameter:wf.DiameterMin,NewWheelWidth:wf.WidthMin}})}
batch.done(function(r){return recommendations=r});batch.execute();var tireConnectURLBase=TireConnectPlugin.BaseURL;var tireConnectParams={};if(!tireConnectURLBase)
console.error("Please set TireConnectPlugin.BaseURL to the URL of the TireConnect widget");{var hashIndex=tireConnectURLBase.lastIndexOf('#');if(hashIndex>=0)
tireConnectURLBase=tireConnectURLBase.substr(0,hashIndex);tireConnectURLBase+='#!wheel_service?'}
tireConnectParams[_this.isVehicleID?'aces_id':'base_aces_id']=_this.currentACESID;var selectTire=function(size){tireConnectParams['tire_width[b]']=size.DisplayWidth;tireConnectParams['tire_height[b]']=size.DisplayAspectRatio;tireConnectParams['tire_rim[b]']=size.DisplayInsideDiameter;tireConnectParams['tire_size[b]']=size.Description};var selectFitment=function(fitment,qty){var r=recommendations[fitment.PartNumber];if(r.Recommendations.length==0){alert('We could not recommend a new tire for this wheel/vehicle combination. Please contact us directly for this application.');return}
selectTire(r.Recommendations[0].Size);tireConnectParams['wheel_brand[b]']=currentWheel.WheelBrandName;tireConnectParams['wheel_product_name[b]']=currentWheel.WheelModelName+' ('+currentWheel.WheelModelFinishDescription+')';tireConnectParams['wheel_image[b]']=RideStylerShowcase.api.getURL("wheel/image",{WheelFitment:fitment.WheelFitmentID,WheelFitmentResourceType:3,IncludeShadow:!0,Width:300,Height:300,PositionX:1,PositionY:1});tireConnectParams['wheel_quantity[b]']=qty;tireConnectParams['wheel_part_number[b]']=fitment.PartNumber;tireConnectParams['wheel_desc[b]']=getFitmentDescription(fitment);{var retailPriceDataObject=getRetailPrice(fitment);var retailPrice=retailPriceDataObject&&retailPriceDataObject.WheelPricingAmount;if(retailPrice>1){tireConnectParams['wheel_price[b]']=retailPriceDataObject.WheelPricingAmount.toString()}}
tireConnectParams['wheel_link[b]']=location.href;tireConnectParams['wheel_link_label[b]']='Edit Wheel';var url=tireConnectURLBase+ridestyler.utils.toParamString(tireConnectParams);if(TireConnectPlugin.OpenInNewTab)
window.open(url,'_blank');else location.href=url};if(wheelFitments.length===0)
return;modal=new SelectWheelFitmentModal(_this.showcase,currentWheel,function(fitment,qty){if(recommendations==null)
return;selectFitment(fitment,qty);modal.hide()});modal.show()});this.events.on("vehicle-selected",function(){setTimeout(function(){return _this.updateTirePackageButton()},0)})};CustomWheelDetails.prototype.setTirePackageButtonVisibility=function(visible){VisibilityHelper.setVisibility(this.createTirePackageButton,visible)};CustomWheelDetails.prototype.updateTirePackageButton=function(){var _this=this;var currentVehicleConfigurationID=this.state.getData().currentVehicleConfigurationID;if(!currentVehicleConfigurationID)
return this.setTirePackageButtonVisibility(!1);RideStylerShowcase.api.request("vehicle/getreferences",{VehicleConfiguration:currentVehicleConfigurationID,VehicleReferenceType:1,VehicleReferenceFields:[16,1]}).done(function(response){var references=response.References;if(!references.length)
return _this.setTirePackageButtonVisibility(!1);var acesID;var isVehicleID=!1;for(var i=0;i<references.length;i++){var reference=references[i];acesID=reference.VehicleReferenceValue;if(reference.VehicleReferenceField===16){isVehicleID=!0;break}}
_this.currentACESID=acesID;_this.isVehicleID=isVehicleID;_this.setTirePackageButtonVisibility(!0)})};return CustomWheelDetails}(RideStylerShowcase.WheelDetails));TireConnectPlugin.CustomWheelDetails=CustomWheelDetails;var SelectWheelFitmentModal=(function(_super){__extends(SelectWheelFitmentModal,_super);function SelectWheelFitmentModal(showcaseInstance,wheelModel,onFitmentSelected){var _this=_super.call(this,showcaseInstance,{removeOnHidden:!0})||this;HTMLHelper.setText(_this.brandTitleElement,wheelModel.WheelBrandName);HTMLHelper.setText(_this.titleElement,wheelModel.WheelModelName);HTMLHelper.setText(_this.subtitleElement,wheelModel.WheelModelFinishDescription);_this.table.appendRows(wheelModel.WheelFitments);_this.onFitmentSelected=onFitmentSelected;return _this}
SelectWheelFitmentModal.prototype.buildModal=function(){var _this=this;_super.prototype.buildModal.call(this);HTMLHelper.createElement('h1',{className:'ridestyler-showcase-product-modal-title',appendTo:this.component,append:[this.brandTitleElement=HTMLHelper.createElementWithClass('span','ridestyler-showcase-product-modal-title-brand'),this.titleElement=HTMLHelper.createElement('span'),this.subtitleElement=HTMLHelper.createElementWithClass('span','ridestyler-showcase-product-modal-title-subtitle')]});HTMLHelper.createElement('p',{text:'Please select a fitment:',appendTo:this.component,style:{marginBottom:'0',fontWeight:'bold'}});HTMLHelper.createElement('small',{text:'Wheel and tire recommendations are for informational purposes only. You should consult with a professional to confirm fit before ordering or installing anything on your vehicle.',style:{color:'#777',fontStyle:'italic'},appendTo:this.component});var tableWrapper=HTMLHelper.createElement('div',{className:'scrollable ridestyler-showcase-product-modal-page',style:{top:'17em'},appendTo:this.component});this.table=new RideStylerShowcaseTable(this.showcase,{columns:[{header:strings.getString('size'),cell:function(fitment){var DiameterMin=fitment.DiameterMin,WidthMin=fitment.WidthMin;if(!DiameterMin||!WidthMin)
return RideStylerShowcaseTable.emptyCellString;return DiameterMin+"\u2033 x "+WidthMin}},{header:strings.getString('offset'),cell:function(fitment){return RideStylerShowcaseTable.formatCell(fitment,'OffsetMin','mm')}},{header:strings.getString('bolt-pattern'),cell:'BoltPatternDescription'},{header:'Price',cell:function(fitment){var noPriceString=strings.getString('call');var retailPriceDataObject=getRetailPrice(fitment);if(!retailPriceDataObject)
return noPriceString;var price=retailPriceDataObject.WheelPricingAmount;if(price<1)
price=undefined;return price?strings.format().currency(price,'$'):noPriceString}},{header:'Item #',cell:function(fitment){var retailPriceDataObject=getRetailPrice(fitment);var itemNumber;if(retailPriceDataObject)
itemNumber=retailPriceDataObject.WheelPricingItemNumber;if(!itemNumber)
itemNumber=fitment.PartNumber;return itemNumber||RideStylerShowcaseTable.emptyCellString}},{header:'Qty',cell:function(fitment){return HTMLHelper.createElement('td',{append:HTMLHelper.createElement('input',{className:'tire-connect-plugin-quantity-input',properties:{type:'number',value:'4',min:'1'}})})}},{header:'',cell:function(fitment){var orderButton=HTMLHelper.createButton({text:'Add to Package'});var td=HTMLHelper.createElement('td',{append:orderButton});orderButton.addEventListener('click',function(e){if(typeof _this.onFitmentSelected!=='function')
return;var qtyInput=td.previousSibling.firstChild;_this.onFitmentSelected(fitment,qtyInput.value)});return td}}]});tableWrapper.appendChild(this.table.component)};return SelectWheelFitmentModal}(RideStylerShowcase.RideStylerShowcaseModal));TireConnectPlugin.SelectWheelFitmentModal=SelectWheelFitmentModal;function getFitmentDescription(fitment){var diameter=fitment.DiameterMin,width=fitment.WidthMin,offset=fitment.OffsetMin,boltPattern=fitment.BoltPatternDescription,finish=fitment.WheelModelFinishDescription;return diameter+"x"+width+" ("+offset+"mm) \u2014 "+boltPattern+" \u2014 "+finish}
function getRetailPrice(fitment){return fitment.Pricing&&fitment.Pricing.Retail||undefined}
{var css="\n        .tire-connect-plugin-quantity-input {\n            width: 50px;\n            border: 1px solid #aaa;\n            border-radius: 6px;\n            padding: 3px 0 3px 13px;\n            text-align: center;\n        }";var head=document.head||document.getElementsByTagName('head')[0];var style=HTMLHelper.createElement('style',{properties:{type:'text/css'},text:css});head.appendChild(style)}})(TireConnectPlugin||(TireConnectPlugin={}));RideStylerShowcase.WheelDetails=TireConnectPlugin.CustomWheelDetails