var rsqv=function(){var e=document.createElement("div");return{bind:function(e){e=e||{};for(var a=document.querySelectorAll("[data-rsqv-wheel-pn]"),s={descriptions:[],matches:[],links:[],render:{},partLookup:{}},r=0;r<a.length;r++){var n=a[r],i=(n.getAttribute("data-rsqv-vehicle-desc")||e.vehicleDesc).toUpperCase(),l=s.descriptions.indexOf(i);-1===l&&(l=s.descriptions.length,s.descriptions.push(i),s.matches.push({models:null,partNumbers:[]}));var o={ele:n,index:l,loadingClass:e.buttonLoadingClass||"rsqv-button-loading"},d=n.getAttribute("data-rsqv-wheel-pn");if(void 0!==d){o.partNumbers=d.split(/[;,:|]/);for(var c=0;c<o.partNumbers.length;c++){var u=o.partNumbers[c];-1===s.matches[l].partNumbers.indexOf(u)&&s.matches[l].partNumbers.push(u)}}s.links.push(o),o.ele.className+=" "+o.loadingClass}var v={Parameters:[],SearchOptions:2};for(r=0;r<s.descriptions.length;r++)v.Parameters.push({ID:r,Search:s.descriptions[r]});ridestyler.ajax.send({action:"Vehicle/Search",data:v,callback:function(e){if(e.Success){for(var a=0;a<e.Results.length;a++){var r=e.Results[a],n=parseInt(r.ID);s.matches[n].models=r.Descriptions}var i=ridestyler.ajax.batch();for(a=0;a<s.matches.length;a++)for(var l=s.matches[a],o=0;o<l.models.length;o++){var d=l.models[o];i.send(a+"_"+o,{action:"Wheel/CanBeRendered",data:{VehicleConfiguration:d.ConfigurationID,PartNumbers:l.partNumbers}})}i.execute(),i.done(function(e){for(var a in e){var r=a.split("_"),n=s.matches[r[0]],i=n.models[r[1]],l=e[a];if(l.Success)for(var o=0;o<n.partNumbers.length;o++){var d=n.partNumbers[o],c=l.PossibleTypes[d];c.Available=c.Angled||c.Side,s.render[i.ConfigurationID+"_"+d]=c}}for(o=0;o<s.links.length;o++){t(s.links[o],s)}})}}})}};function t(e,t){for(var s=e.partNumbers,r=t.matches[e.index].models.slice(),n=r.length-1;n>=0;n--){var i=r[n].ConfigurationID+"_"+s[0];0==t.render[i].Available&&r.splice(n,1)}r.length>0?e.ele.addEventListener("click",function(){var e=function(e,t){var s=sessionStorage.getItem("last-vehicle-id")||e[0].ConfigurationID,r=[],n=a('<div class="rsqv-modal-wrapper"></div>');n.addEventListener("click",function(){-1!==n.className.indexOf("show")&&(n.className=n.className.replace(" show",""),setTimeout(function(){document.body.removeChild(n)},2e3))});var i=a('<div class="rsqv-modal-container"></div>');n.appendChild(i),i.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()});var l=a('<div class="rsqv-modal-header"></div>');i.appendChild(l);var o=a('<select class="rsqv-model-selection"></div>');l.appendChild(o);var d=a('<div class="rsqv-modal-body"></div>');i.appendChild(d);var c=a('<div class="rsqv-modal-viewport"></div>');d.appendChild(c);var u=new RideStylerViewport(c,{containerAspectRatio:.42});function v(e){sessionStorage.setItem("last-vehicle-id",e);for(var a=0;a<r.length;a++){var s=r[a];s.value===e?s.setAttribute("selected","selected"):s.removeAttribute("selected")}u.Update({PositionX:1,PositionY:2,VehicleConfiguration:e,WheelPartNumber:t,ExcludeDiscontinuedWheels:!0})}o.addEventListener("change",function(){v(o.options[o.selectedIndex].value)});for(var p=!1,h=0;h<e.length;h++){var m=e[h],f=a("<option></option>");f.value=m.ConfigurationID,f.innerHTML=m.FullDescription,m.ConfigurationID==s&&(f.setAttribute("selected","selected"),p=!0),o.appendChild(f),r.push(f)}console.log(e),!1===p&&(s=e[0].ConfigurationID);return v(s),n}(r,s[0]);document.body.appendChild(e),setTimeout(function(){e.className+=" show"},10)}):e.ele.className+=" rsqv-button-disabled",e.ele.className=e.ele.className.replace(e.loadingClass,"")}function a(t){return e.innerHTML=t,e.firstChild}}();