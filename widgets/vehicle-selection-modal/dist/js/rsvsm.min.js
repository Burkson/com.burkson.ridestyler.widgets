function RideStylerVehicleSelectionModal(e){function t(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e}function n(e,t){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var n=0;n<e.length;n++)""==e[n].className.trim()?e[n].className=t:(" "+e[n].className+" ").indexOf(" "+t+" ")<0&&(e[n].className+=" "+t)}}function i(e,t){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var n=new RegExp(" "+t+" ","g"),i=new RegExp("(^)"+t+"($| )","g"),o=new RegExp("(^| )"+t+"($)","g"),a=0;a<e.length;a++)e[a].className=e[a].className.replace(n," "),e[a].className=e[a].className.replace(i,""),e[a].className=e[a].className.replace(o,""),""==e[a].className.trim()&&e[a].removeAttribute("class")}}function o(){if(!document.getElementById("vsm-backdrop")){var e=document.createElement("div");e.id="vsm-backdrop",e.style.opacity=0,e.style.transition="opacity linear .3s",r().appendChild(e),function(){var e=document.getElementById("vsm-backdrop");e||o();setTimeout(function(){e.style.opacity=.55,e.onTransitionEndOnce(function(){})},0)}()}}function a(){var e=document.getElementById("vsm-backdrop");e&&(e.style.opacity=0,e.onTransitionEndOnce(function(){e.parentNode.removeChild(e)}))}function l(){var t=document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)"),n=document.querySelectorAll(".vsm-modal.in")[0],o=u.slice(0),l=p.slice(0);u=[],p=[],h=!0,f.indexOf(n.getAttribute("id"))>-1?(n.style.opacity=0,n.onTransitionEndOnce(function(){[].forEach.call(t,function(e){var t=e.getAttribute("id");f.indexOf(t)>-1&&e.parentNode.removeChild(e)});for(var n={},i=0;i<o.length;i++){var a=o[i].split(":");2==a.length&&(n[a[0]]=a[1])}if(e.callback&&"function"==typeof e.callback){var r={FinalSelectionMade:!1,Vehicle:n,FullSelectionData:l};e.callback(r)}else console.warn("No callback function provided.")}),a(),i(document.body,"vsm-modal-open")):console.warn("This vsm instance is not shown yet.")}function r(){return"function"==typeof e.container?e.container():e.container?e.container:document.body}function s(n,i,o){var a=document.getElementById("vsm_modal_base");if(a){var s=a.cloneNode(!0);if(s.id="vsm_modal_"+_vsmModalIDCounter,f.push("vsm_modal_"+_vsmModalIDCounter),s.className+=" vsm_modal_"+_vsmModalIDCounter,r().appendChild(s),void 0!==o){i=t({backModal:o,thisModal:s},i);var d=s.querySelectorAll(".vsm-back-step");[].forEach.call(d,function(t){var n=function(t){t.target.removeEventListener(t.type,n);var o=i.backModal,a=i.thisModal;c(o,a,!0).done(function(){if(u.length&&u.pop(),p.length&&p.pop(),a.parentNode&&a.parentNode.removeChild(a),e.afterBackClicked&&"function"==typeof e.afterBackClicked){for(var t={},n=0;n<u.length;n++){var i=u[n].split(":");2==i.length&&(t[i[0]]=i[1])}var o={FullSelection:t,FullSelectionData:p};e.afterBackClicked(o)}})};t.addEventListener("click",n,!1)})}"function"==typeof n&&n(s,i);var m=s.querySelectorAll(".vsm-close");return[].forEach.call(m,function(e){e.onclick=function(){l()}}),_vsmModalIDCounter++,s}}function c(e,t,o){if(o=!!o,e&&t){var a=ridestyler.promise(),l=ridestyler.promise();if(!o){var r=parseInt(t.style.zIndex,10)||0,s=parseInt(e.style.zIndex,10)||0;s<=r&&(s=r+1),e.style.zIndex=s}y?o?(e.style.display="block",n(e,"in"),l.resolve(),setTimeout(function(){i(t,"in"),t.onTransitionEndOnce(function(){t.style.display="none",a.resolve()})},50)):(e.style.display="block",setTimeout(function(){n(e,"in"),e.onTransitionEndOnce(function(){t.style.display="none",i(t,"in"),l.resolve(),a.resolve()})},50)):(o?(e.style.display="block",n(e,"in"),i(t,"in"),t.style.display="none"):(e.style.display="block",n(e,"in"),t.style.display="none",i(t,"in")),l.resolve(),a.resolve());var c=ridestyler.promise(),d=function(){var e=l.state(),t=a.state();if(0!==e&&0!==t)return 2===e||2===t?c.reject():void c.resolve()};return l.always(d),a.always(d),c}}function d(t,n){var i={Selection:p};n&&n.bestConfiguration?v(t,n.bestConfiguration):ridestyler.ajax.send({action:"Vehicle/Select",data:i,callback:function(n){n.Success&&(n.BestConfiguration?e.IncludeOETireOption?ridestyler.ajax.send({action:"Vehicle/GetTireOptionDetails",data:{VehicleConfiguration:n.BestConfiguration.Value},bestConfiguration:n.BestConfiguration,callback:function(e){if(e.Success){var n=e.Details,i=this.bestConfiguration;if(1==n.length){var o=function(e){var t=e.Front.Description,n=e.Rear.Description;return t==n?t:"F: "+t+" R: "+n}(n[0]);i.TireOptionBasic={TireOptionID:n[0].TireOptionID,TireOptionString:o},v(t,i)}else{for(var a={Groups:null,Description:"Select Your Tire Size",Title:"Tire Size",Key:"tireoption",Options:[]},l=0;l<n.length;l++){o=function(e){var t=e.Front.Description,n=e.Rear.Description;return t==n?t:"F: "+t+" R: "+n}(n[l]);a.Options.push({Group:null,Label:o,Value:n[l].TireOptionID})}m(t,a,i)}}else v(t,i)}}):v(t,n.BestConfiguration):m(t,n.Menu))}})}function m(t,i,o){var a=t.querySelectorAll(".vsm-list-container")[0],l=t.querySelectorAll(".vsm-header")[0],r=t.querySelectorAll(".vsm-modal-body")[0],m=t.querySelectorAll(".vsm-line-step")[0],v=t.querySelectorAll(".vsm-final")[0],f=i.Options,y=i.Key,g=i.Title,b=i.Groups,S=function(n){var i=n.Label,a=n.Value;if(void 0!==i&&void 0!==a){var l=document.createElement("a"),r=document.createTextNode(i);return l.className="vsm-option-item vsm-btn vsm-btn-gray",l.href="javascript:void(0)",l.setAttribute("data-optionvalue",a),l.setAttribute("data-optionlabel",i),l.appendChild(r),l.onclick=function(){!function(n){var i=n.getAttribute("data-optionvalue"),a=n.getAttribute("data-optionkey"),l=n.getAttribute("data-optionlabel"),r=n.getAttribute("data-menutitle");if(p.push(a+":"+i),u.push(r+":"+l),e.afterOptionSelected&&"function"==typeof e.afterOptionSelected){for(var m={},v=0;v<u.length;v++){var f=u[v].split(":");2==f.length&&(m[f[0]]=f[1])}var y={CurrentSelection:{},FullSelection:m,FullSelectionData:p};y.CurrentSelection[r]=l,e.afterOptionSelected(y)}if(!h){var g={};"tireoption"==a&&o&&(o.TireOptionBasic={TireOptionID:i,TireOptionString:l},g.bestConfiguration=o),c(s(d,g,t),t)}}(this)},l}},C=function(e){var t=document.createElement("p"),n=document.createTextNode(e);return t.className="vsm-group-title",t.appendChild(n),t};v.parentNode.removeChild(v),n(m,"vsm-single-step");var k=document.createElement("div"),E=document.createElement("i"),T=document.createElement("span");if(k.className="vsm-column-2",E.className="dot-style dot-before active",T.className="dot-info dot-info-before active",k.appendChild(E),k.appendChild(T),p.length){n(r,"vsm-has-back");(N=document.createElement("div")).className="vsm-column-2 vsm-before";var O=u.map(function(e){return e&&2===e.split(":").length?e.split(":")[1]:""});T.innerHTML=O.join(" "),m.appendChild(N),m.appendChild(k)}else{var N;(N=document.createElement("div")).className="vsm-column-2 no-style",m.appendChild(N),m.appendChild(k)}for(l.innerHTML=i.Description;a.firstChild;)a.removeChild(a.firstChild);if(f.length){var A=document.createElement("div");if(A.className="vsm-group-wrap center-piece",a.appendChild(A),e.GroupOptions&&b){for(var _={},I=0;I<f.length;I++){var M=f[I],D=M.Group;D?_[D]?_[D].push(M):_[D]=[M]:_._ungrouped?_._ungrouped.push(M):_._ungrouped=[M]}for(var q=0;q<b.length;q++){var w=b[q];if(L=_[w]){var x=document.createElement("div"),B="vsm-one-container";"year"==i.Key&&f.length>10&&(2==e.YearScreenColumns&&(B="vsm-half-container"),e.YearScreenColumns>=3&&(B="vsm-third-container")),"make"==i.Key&&f.length>10&&e.MakeScreenColumns>=2&&(B="vsm-half-container"),x.className="vsm-group-list "+B,A.appendChild(C(w)),A.appendChild(x);for(I=0;I<L.length;I++){void 0!==(V=S(L[I]))&&(V.setAttribute("data-optionkey",y),V.setAttribute("data-menutitle",g),x.appendChild(V))}}}if(_._ungrouped){x=document.createElement("div"),B="vsm-one-container";"year"==i.Key&&f.length>10&&(2==e.YearScreenColumns&&(B="vsm-half-container"),e.YearScreenColumns>=3&&(B="vsm-third-container")),"make"==i.Key&&f.length>10&&e.MakeScreenColumns>=2&&(B="vsm-half-container"),x.className="vsm-group-list "+B,A.appendChild(C("Ungrouped")),A.appendChild(x);var L=_._ungrouped;for(I=0;I<L.length;I++){void 0!==(V=S(L[I]))&&(V.setAttribute("data-optionkey",y),V.setAttribute("data-menutitle",g),x.appendChild(V))}}}else{x=document.createElement("div"),B="vsm-one-container";"year"==i.Key&&f.length>10&&(2==e.YearScreenColumns&&(B="vsm-half-container"),e.YearScreenColumns>=3&&(B="vsm-third-container")),"make"==i.Key&&f.length>10&&e.MakeScreenColumns>=2&&(B="vsm-half-container"),x.className="vsm-group-list "+B,A.appendChild(x);for(I=0;I<f.length;I++){var V;void 0!==(V=S(f[I]))&&(V.setAttribute("data-optionkey",y),V.setAttribute("data-menutitle",g),x.appendChild(V))}}}}function v(i,o){var r=i.querySelectorAll(".vsm-vehicle-display")[0],s=i.querySelectorAll(".vsm-final .vsm-loaderIcon")[0],c=i.querySelectorAll(".vehicle-result-name")[0],d=(i.querySelectorAll(".vehicle-result-size")[0],i.querySelectorAll(".vsm-find")[0]),m=i.querySelectorAll(".vsm-modal-body")[0],v=i.querySelectorAll(".vsm-in-progress")[0];n(m,"vsm-has-back"),d.innerHTML=e.ConfirmButtonText;for(var f=[],h={},y=0;y<u.length;y++){var g=u[y].split(":");2==g.length&&"Tire Size"!=g[0]&&(f.push(g[1]),h[g[0]]=g[1])}var b=f[0],S=f.pop();for(y=1;y<f.length&&!(y>=3);y++)b+=" "+f[y];var C=b+" "+S;c.innerHTML=C,n(i.querySelectorAll(".vsm-modal-body")[0],"vsm-final-screen"),v.parentNode.removeChild(v);var k={Width:260,Height:120,PositionX:1,PositionY:1};e.ImageSettings&&t(k,"function"==typeof e.ImageSettings?e.ImageSettings.call(this,e):e.ImageSettings),k.VehicleConfiguration=o.Value;var E=ridestyler.ajax.url("Vehicle/Render",k);r.src=E,r.style.display="inline-block",r.onload=function(){s.style.display="none"};var T=function(n){n.target.removeEventListener(n.type,T);var i=document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)"),r=function(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null}(this,".vsm-modal"),s=p.slice(0);u=[],p=[],r.style.opacity=0,r.onTransitionEndOnce(function(){[].forEach.call(i,function(e){e.parentNode.removeChild(e)});var n={ImageUrl:E,VehicleDescription:C,VehicleConfiguration:o.Value};if(t(n,h),o.TireOptionBasic&&t(n,o.TireOptionBasic),e.callback&&"function"==typeof e.callback){var a={FinalSelectionMade:!0,Vehicle:n,FullSelectionData:s};e.callback(a)}else l(),console.warn("No callback function provided.")}),a()};d.addEventListener("click",T,!1)}var u=[],p=[],f=[],h=!1;e=t({ConfirmButtonText:"Confirm Vehicle",GroupOptions:!1,IncludeOETireOption:!1,YearScreenColumns:3,MakeScreenColumns:2,container:document.body,afterBackClicked:null,afterOptionSelected:null,callback:null},e);var y=function(){var e=(document.body||document.documentElement).style;return void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.OTransition||void 0!==e.transition}();!function(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},i="";for(e in n)if(n.hasOwnProperty(e)&&void 0!==t.style[e]){i=n[e];break}HTMLElement.prototype.onTransitionEndOnce=function(e){if(""===i)return e(),this;var t=function(n){e(),n.target.removeEventListener(n.type,t)};return this.addEventListener(i,t,!1),this}}(),this.Show=function(){!function(){if(!document.getElementById("vsm_modal_base")){var e=document.createElement("div");e.innerHTML=vsm_template,r().appendChild(e.firstChild)}}();if(document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)").length)console.warn("There is currently another vsm instance running.");else{var e=s();o(),e.style.display="block",h=!1,setTimeout(function(){n(e,"in"),n(document.body,"vsm-modal-open"),e.onTransitionEndOnce(function(){d(e)})},50)}},this.Hide=l}var vsm_template='<div id="vsm_modal_base" class="vsm-modal vsm-hide vsm-fade" style="z-index: 9999;" tabindex="-1" role="dialog"> <div class="vsm-modal-dialog"> <div class="vsm-modal-content"> <div class="vsm-modal-header"> <button type="button" class="vsm-close"> </button> </div><div class="vsm-modal-body vsm-option-body vsm-list-body"> <a href="javascript:void(0);" class="vsm-back-link vsm-back-step"> <i class="vsm-back-arrow"></i> </a> <div class="vsm-in-progress"> <p class="vsm-header vsm-center"></p><div class="vsm-line-step center-piece vsm-columns"> </div><div class="vsm-list-container"> <i class="vsm-loaderIcon" alt="Loading options"></i> </div></div><div class="vsm-final"> <div class="center-piece vsm-line-step vsm-columns vehicle-result-wrap"> <div class="vsm-column-2 vsm-before"></div><div class="vsm-column-2 no-style"><i class="dot-style dot-before active"></i></div><p class="vehicle-result-name"></p><p class="vehicle-result-size"></p></div> <div class="center-piece vehicle-image-wrap"> <div style="position: relative; text-align: center; min-height: 120px;"> <i class="vsm-loaderIcon" alt="Loading an image of your vehicle"></i> <img src="" alt="" class="vsm-vehicle-display" style="display: none;"> </div><a href="javascript:void(0);" class="vsm-btn vsm-btn-gray vsm-full-width vsm-find"></a> </div></div></div></div></div></div>',_vsmModalIDCounter=0;