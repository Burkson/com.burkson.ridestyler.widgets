function RideStylerVehicleSelectionModal(e){function t(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e}function n(e,t){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var n=0;n<e.length;n++)""==e[n].className.trim()?e[n].className=t:(" "+e[n].className+" ").indexOf(" "+t+" ")<0&&(e[n].className+=" "+t)}}function i(e,t){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var n=new RegExp(" "+t+" ","g"),i=new RegExp("(^)"+t+"($| )","g"),a=new RegExp("(^| )"+t+"($)","g"),l=0;l<e.length;l++)e[l].className=e[l].className.replace(n," "),e[l].className=e[l].className.replace(i,""),e[l].className=e[l].className.replace(a,""),""==e[l].className.trim()&&e[l].removeAttribute("class")}}function a(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null}function l(){if(!document.getElementById("vsm-backdrop")){var e=document.createElement("div");e.id="vsm-backdrop",e.style.opacity=0,e.style.transition="opacity linear .3s",c().appendChild(e),o()}}function o(){var e=document.getElementById("vsm-backdrop");e||l(),setTimeout(function(){e.style.opacity=.55,e.onTransitionEndOnce(function(){})},0)}function r(){var e=document.getElementById("vsm-backdrop");e&&(e.style.opacity=0,e.onTransitionEndOnce(function(){e.parentNode.removeChild(e)}))}function s(){var t=document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)"),n=document.querySelectorAll(".vsm-modal.in")[0],i=h.slice(0),a=y.slice(0);h=[],y=[],b=!0,g.indexOf(n.getAttribute("id"))>-1?(n.style.opacity=0,n.onTransitionEndOnce(function(){[].forEach.call(t,function(e){var t=e.getAttribute("id");g.indexOf(t)>-1&&e.parentNode.removeChild(e)});for(var n={},l=0;l<i.length;l++){var o=i[l].split(":");2==o.length&&(n[o[0]]=o[1])}if(e.callback&&"function"==typeof e.callback){var r={FinalSelectionMade:!1,Vehicle:n,FullSelectionData:a};e.callback(r)}else console.warn("No callback function provided.")}),r()):console.warn("This vsm instance is not shown yet.")}function c(){return"function"==typeof e.container?e.container():e.container?e.container:document.body}function d(){if(!document.getElementById("vsm_modal_base")){var e=document.createElement("div");e.innerHTML=vsm_template,c().appendChild(e.firstChild)}}function m(n,i,a){var l=document.getElementById("vsm_modal_base");if(l){var o=l.cloneNode(!0);if(o.id="vsm_modal_"+_vsmModalIDCounter,g.push("vsm_modal_"+_vsmModalIDCounter),o.className+=" vsm_modal_"+_vsmModalIDCounter,c().appendChild(o),void 0!==a){i=t({backModal:a,thisModal:o},i);var r=o.querySelectorAll(".vsm-back-step");[].forEach.call(r,function(t){var n=function(t){t.target.removeEventListener(t.type,n);var a=i.backModal,l=i.thisModal;v(a,l,!0).done(function(){if(h.length&&h.pop(),y.length&&y.pop(),l.parentNode&&l.parentNode.removeChild(l),e.afterBackClicked&&"function"==typeof e.afterBackClicked){for(var t={},n=0;n<h.length;n++){var i=h[n].split(":");2==i.length&&(t[i[0]]=i[1])}var a={FullSelection:t,FullSelectionData:y};e.afterBackClicked(a)}})};t.addEventListener("click",n,!1)})}"function"==typeof n&&n(o,i);var d=o.querySelectorAll(".vsm-close");return[].forEach.call(d,function(e){e.onclick=function(){s()}}),_vsmModalIDCounter++,o}}function v(e,t,a){if(a=!!a,e&&t){var l=ridestyler.promise(),o=ridestyler.promise();if(!a){var r=parseInt(t.style.zIndex,10)||0,s=parseInt(e.style.zIndex,10)||0;s<=r&&(s=r+1),e.style.zIndex=s}A?a?(e.style.display="block",n(e,"in"),o.resolve(),setTimeout(function(){i(t,"in"),t.onTransitionEndOnce(function(){t.style.display="none",l.resolve()})},50)):(e.style.display="block",setTimeout(function(){n(e,"in"),e.onTransitionEndOnce(function(){t.style.display="none",i(t,"in"),o.resolve(),l.resolve()})},50)):(a?(e.style.display="block",n(e,"in"),i(t,"in"),t.style.display="none"):(e.style.display="block",n(e,"in"),t.style.display="none",i(t,"in")),o.resolve(),l.resolve());var c=ridestyler.promise(),d=function(){var e=o.state(),t=l.state();if(0!==e&&0!==t)return 2===e||2===t?c.reject():void c.resolve()};return o.always(d),l.always(d),c}}function u(e){var t={Selection:y};ridestyler.ajax.send({action:"Vehicle/Select",data:t,callback:function(t){t.Success&&(t.BestConfiguration?f(e,t.BestConfiguration):p(e,t.Menu))}})}function p(t,i){var a=t.querySelectorAll(".vsm-list-container")[0],l=t.querySelectorAll(".vsm-header")[0],o=t.querySelectorAll(".vsm-modal-body")[0],r=t.querySelectorAll(".vsm-line-step")[0],s=t.querySelectorAll(".vsm-final")[0],c=i.Options,d=i.Key,p=i.Title,f=i.Groups,g=function(n){var i=n.getAttribute("data-optionvalue"),a=n.getAttribute("data-optionkey"),l=n.getAttribute("data-optionlabel"),o=n.getAttribute("data-menutitle");if(y.push(a+":"+i),h.push(o+":"+l),e.afterOptionSelected&&"function"==typeof e.afterOptionSelected){for(var r={},s=0;s<h.length;s++){var c=h[s].split(":");2==c.length&&(r[c[0]]=c[1])}var d={CurrentSelection:{},FullSelection:r,FullSelectionData:y};d.CurrentSelection[o]=l,e.afterOptionSelected(d)}b||v(m(u,{},t),t)},A=function(e){var t=e.Label,n=e.Value;if(void 0!==t&&void 0!==n){var i=document.createElement("a"),a=document.createTextNode(t);return i.className="vsm-option-item vsm-btn vsm-btn-gray",i.href="javascript:void(0)",i.setAttribute("data-optionvalue",n),i.setAttribute("data-optionlabel",t),i.appendChild(a),i.onclick=function(){g(this)},i}},S=function(e){var t=document.createElement("p"),n=document.createTextNode(e);return t.className="vsm-group-title",t.appendChild(n),t};s.parentNode.removeChild(s),n(r,"vsm-single-step");var E=document.createElement("div"),C=document.createElement("i"),k=document.createElement("span");if(E.className="vsm-column-2",C.className="dot-style dot-before active",k.className="dot-info dot-info-before active",k.innerHTML=p,E.appendChild(C),E.appendChild(k),y.length){n(o,"vsm-has-back");var N=document.createElement("div"),T=document.createElement("span"),O=document.createElement("span");N.className="vsm-column-2 no-style vsm-table",T.className="vsm-table-cell",O.className="vsm-selected-info",T.appendChild(O),N.appendChild(T);var x=h.map(function(e){return e&&2===e.split(":").length?e.split(":")[1]:""});O.innerHTML=x.join(" "),r.appendChild(N),r.appendChild(E)}else(N=document.createElement("div")).className="vsm-column-2 no-style",r.appendChild(N),r.appendChild(E);for(l.innerHTML=i.Description;a.firstChild;)a.removeChild(a.firstChild);if(c.length){var D=document.createElement("div");if(D.className="vsm-group-wrap center-piece",a.appendChild(D),e.GroupOptions&&f){for(var I={},M=0;M<c.length;M++){var _=c[M],q=_.Group;q?I[q]?I[q].push(_):I[q]=[_]:I._ungrouped?I._ungrouped.push(_):I._ungrouped=[_]}for(var w=0;w<f.length;w++){var V=f[w];if(Z=I[V]){(L=document.createElement("div")).className="vsm-group-list vsm-one-container",L.appendChild(S(V)),D.appendChild(L);for(M=0;M<Z.length;M++)void 0!==(B=A(Z[M]))&&(B.setAttribute("data-optionkey",d),B.setAttribute("data-menutitle",p),L.appendChild(B))}}if(I._ungrouped){(L=document.createElement("div")).className="vsm-group-list vsm-one-container",L.appendChild(S("Ungrouped")),D.appendChild(L);for(var Z=I._ungrouped,M=0;M<Z.length;M++)void 0!==(B=A(Z[M]))&&(B.setAttribute("data-optionkey",d),B.setAttribute("data-menutitle",p),L.appendChild(B))}}else{var L=document.createElement("div");L.className="vsm-group-list vsm-one-container",D.appendChild(L);for(M=0;M<c.length;M++){var B=A(c[M]);void 0!==B&&(B.setAttribute("data-optionkey",d),B.setAttribute("data-menutitle",p),L.appendChild(B))}}}}function f(i,l){var o=i.querySelectorAll(".vsm-vehicle-display")[0],c=i.querySelectorAll(".vsm-final .vsm-loaderIcon")[0],d=i.querySelectorAll(".vehicle-result-name")[0],m=(i.querySelectorAll(".vehicle-result-size")[0],i.querySelectorAll(".vsm-find")[0]),v=i.querySelectorAll(".vsm-modal-body")[0],u=i.querySelectorAll(".vsm-in-progress")[0];n(v,"vsm-has-back"),m.innerHTML=e.ConfirmButtonText;for(var p=[],f={},g=0;g<h.length;g++){var b=h[g].split(":");2==b.length&&(p.push(b[1]),f[b[0]]=b[1])}for(var A=p[0],S=p.pop(),g=1;g<p.length&&!(g>=3);g++)A+=" "+p[g];var E=A+" "+S;d.innerHTML=E,n(i.querySelectorAll(".vsm-modal-body")[0],"vsm-final-screen"),u.parentNode.removeChild(u);var C={Width:260,Height:120,PositionX:1,PositionY:1};e.ImageSettings&&t(C,e.ImageSettings),C.VehicleConfiguration=l.Value;var k=ridestyler.ajax.url("Vehicle/Render",C);o.src=k,o.style.display="inline-block",o.onload=function(){c.style.display="none"};ridestyler.ajax.send({data:{VehicleConfiguration:l.Value},action:"Vehicle/GetTireOptionDetails",callback:function(e){if(e.Success){var t=e.Details;if(t.length>1){var n=document.createElement("select");n.className="vsm-options-select";var i=document.createElement("option");i.text="Select a Tire Size",i.value="",n.appendChild(i);for(var a=0;a<t.length;a++){var l=t[a],o=document.createElement("option"),r=function(e){var t=e.Front.Description,n=e.Rear.Description;return t==n?t:"F: "+t+" R: "+n}(l);o.text=r,o.value=l.TireOptionID,n.appendChild(o)}m.parentNode.insertBefore(n,m)}else if(t.length>0){var s=document.createElement("input");s.className="vsm-options-select",s.type="hidden",r=function(e){var t=e.Front.Description,n=e.Rear.Description;return t==n?t:"F: "+t+" R: "+n}(t[0]),s.setAttribute("data-detail-string",r),s.value=t[0].TireOptionID,m.parentNode.insertBefore(s,m)}}}});var N=function(n){n.target.removeEventListener(n.type,N);var o=document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)"),c=a(this,".vsm-modal"),d=y.slice(0);h=[],y=[],c.style.opacity=0,c.onTransitionEndOnce(function(){[].forEach.call(o,function(e){e.parentNode.removeChild(e)});var n={ImageUrl:k,VehicleDescription:E,VehicleConfiguration:l.Value},a=i.querySelectorAll(".vsm-options-select")[0];if(n.TireOptionID=a.value,""==a.value?n.TireSizeString="":a.getAttribute("data-detail-string")?n.TireSizeString=a.getAttribute("data-detail-string"):-1==a.selectedIndex?n.TireSizeString="":n.TireSizeString=a.options[a.selectedIndex].text,t(n,f),e.callback&&"function"==typeof e.callback){var r={FinalSelectionMade:!0,Vehicle:n,FullSelectionData:d};e.callback(r)}else s(),console.warn("No callback function provided.")}),r()};m.addEventListener("click",N,!1)}var h=[],y=[],g=[],b=!1;e=t({ConfirmButtonText:"Confirm Vehicle",GroupOptions:!1,container:document.body,afterBackClicked:null,afterOptionSelected:null,callback:null},e);var A=function(){var e=(document.body||document.documentElement).style;return void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.OTransition||void 0!==e.transition}();!function(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},i="";for(e in n)if(n.hasOwnProperty(e)&&void 0!==t.style[e]){i=n[e];break}HTMLElement.prototype.onTransitionEndOnce=function(e){if(""===i)return e(),this;var t=function(n){e(),n.target.removeEventListener(n.type,t)};return this.addEventListener(i,t,!1),this}}(),this.Show=function(){if(d(),document.querySelectorAll(".vsm-modal:not(#vsm_modal_base)").length)console.warn("There is currently another vsm instance running.");else{var e=m();l(),e.style.display="block",b=!1,setTimeout(function(){n(e,"in"),e.onTransitionEndOnce(function(){u(e)})},50)}},this.Hide=s}var vsm_template='<div id="vsm_modal_base" class="vsm-modal vsm-hide vsm-fade" style="z-index: 9999;" tabindex="-1" role="dialog"> <div class="vsm-modal-container"> <div class="vsm-modal-header"> <button type="button" class="vsm-close"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAARVBMVEUAAACdnZ2ampqbm5ubm5uampqdnZ2ZmZmZmZmZmZmcnJyZmZmZmZmdnZ2ZmZmZmZmbm5uZmZmbm5ubm5uZmZmcnJybm5v/bA1VAAAAF3RSTlMAFL8yOr0Qz//tMvHLEs3zNO8wNuswLru4YpkAAADeSURBVHgBvdUFisQAEETRjrvL/W+6Em8+1PoWNpO8H5y2/1oQRhrESep8lhel9FVeN87nvqDP87ZxXhVxt4GsuT0K+K0Itv9hnrOA3xZuD/rBFcIXkZku6HVBrwt6XdDrgl4V8KOZLui5yRf0unj4md5YPPxiHAt6XdDrQntRzCsFC3i9sriDLv6a1wW9Luh1QS8L+mGWBf20yoLeTBf0sqDftogCnoX0opDebCxcIT2KKhZeFtHD94axCKV3H0zcyYJHUad2FvAocEbhUWTuUMOj2PxdhN6zCAP7p70CQy4hRTemab0AAAAASUVORK5CYII=" style="width:24px;"></button> </div><div class="vsm-modal-body vsm-option-body vsm-list-body"> <a href="javascript:void(0);" class="vsm-back-link vsm-back-step">❮ </a> <div class="vsm-in-progress"> <p class="vsm-header vsm-center"></p><div class="vsm-line-step center-piece vsm-columns"> </div><div class="vsm-list-container scrollable"><i class="vsm-loaderIcon" alt="Loading options"></i></div></div><div class="vsm-final"> <div class="center-piece vsm-line-step vehicle-result-wrap"> <i class="dot-style dot-before active"></i> <p class="vehicle-result-name"></p><p class="vehicle-result-size"></p></div><div class="scrollable"> <div class="center-piece vehicle-image-wrap"> <div style="position: relative; text-align: center; min-height: 120px;"> <i class="vsm-loaderIcon" alt="Loading an image of your vehicle"></i> <img src="" alt="" class="vsm-vehicle-display" style="display: none;"> </div><a href="javascript:void(0);" class="vsm-btn vsm-btn-gray vsm-full-width vsm-find"></a> </div></div></div></div></div></div>',_vsmModalIDCounter=0;